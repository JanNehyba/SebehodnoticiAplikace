<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>SKPKS – Sebehodnocení kompetencí</title>
<style>
  :root{
    --muni-blue:#0044cc;
    --muni-blue-700:#0037a6;

    /* Oblastní barvy (2–6) */
    --area2:#ffb000; /* 2 Plánování */
    --area3:#6bbf59; /* 3 Prostředí */
    --area4:#ff6a00; /* 4 Výuka/strategie */
    --area5:#d3b58f; /* 5 Hodnocení */
    --area6:#8aa0b8; /* 6 Spolupráce/rozvoj */

    --bg:#f7f7fb;
    --text:#1d2433;
    --muted:#6b7280;
    --card:#ffffff;
    --border:#e5e7eb;
    --chip:#eef2ff;

    /* Bubble palette (blue-gray intensity) */
    --b0:#eef2ff; --b0b:#e0e7ff;
    --b1:#dbeafe; --b1b:#bfdbfe;
    --b2:#bfdbfe; --b2b:#93c5fd;
    --b3:#93c5fd; --b3b:#60a5fa;
  }
  html,body{margin:0;background:var(--bg);color:var(--text);font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Inter,Helvetica,Arial,sans-serif}
  header{
    background:linear-gradient(120deg,var(--muni-blue),var(--muni-blue-700));
    color:#fff;padding:20px 16px;
  }
  header h1{margin:0;font-size:clamp(20px,2.2vw,28px);letter-spacing:.3px}
  header p{margin:.35rem 0 0;opacity:.95;max-width:1100px}
  .wrap{max-width:1280px;margin:0 auto;padding:16px}

  /* Tabs & toolbar */
  .tabs{display:flex;gap:8px;flex-wrap:wrap;margin:10px 0 16px}
  .tab-btn{
    border:1px solid var(--border);background:#fff;border-radius:10px;padding:10px 14px;
    cursor:pointer;font-weight:600;transition:.15s;box-shadow:0 1px 2px rgba(11,14,22,.05)
  }
  .tab-btn[aria-selected="true"]{background:var(--muni-blue);color:#fff;border-color:transparent}
  .toolbar{display:flex;gap:12px;align-items:center;flex-wrap:wrap;margin:10px 0 16px}
  .toolbar .chip{background:var(--chip);color:#2b2f3a;border-radius:999px;padding:6px 10px;font-size:13px}
  .toolbar label.switch{display:inline-flex;gap:8px;align-items:center;font-weight:600}
  .toolbar input[type="checkbox"]{transform:scale(1.2)}
  .btn{border:1px solid var(--border);background:#fff;border-radius:10px;padding:10px 12px;cursor:pointer;font-weight:600}

  /* Grid & cards */
  .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(380px,1fr)); gap:12px}
  .card{
    background:var(--card);border:1px solid var(--border);border-radius:14px;padding:12px 12px 12px;
    box-shadow:0 2px 6px rgba(15,18,28,.04);display:flex;flex-direction:column;gap:10px;
  }
  .card h3{margin:0;font-size:16px}
  .badge{font-weight:700;font-size:12px;text-transform:uppercase;letter-spacing:.06em;border-radius:6px;padding:3px 8px;display:inline-block}
  .a2{background:var(--area2);color:#231c00}.a3{background:var(--area3);color:#052a0b}.a4{background:var(--area4);color:#2a0b00}
  .a5{background:var(--area5);color:#2a1500}.a6{background:var(--area6);color:#001428}
  .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
  .muted{color:var(--muted);font-size:13px}
  .scale{display:flex;align-items:center;gap:8px}
  .scale input[type="range"]{width:240px}
  .pill{border:1px solid var(--border);border-radius:8px;padding:4px 8px;font-size:12px}
  .anchors{background:#fafafa;border:1px dashed var(--border);padding:10px;border-radius:10px;font-size:13px;display:none}
  .anchors ul{margin:6px 0 0 16px;padding:0}
  .anchors li{margin:4px 0}

  /* Note/textarea – overflow fix */
  .note{
    width:100%;
    max-width:100%;
    min-height:110px;
    border:1px solid var(--border);
    border-radius:10px;
    padding:10px;
    font-size:14px;
    background:#fff;
    resize:vertical;
    box-sizing:border-box;
  }

  .help{font-size:12px;color:#374151;background:#f3f4f6;border:1px solid var(--border);padding:8px;border-radius:8px}
  .files{display:flex;gap:8px;flex-wrap:wrap;margin-top:6px}
  .file-thumb{border:1px solid var(--border);border-radius:8px;padding:6px;background:#fff;font-size:12px}
  .file-thumb img{display:block;max-width:140px;max-height:90px}
  .small{font-size:12px}

  .sticky-summary{position:sticky;top:0;z-index:33;background:var(--bg);padding:6px 0 10px}

  /* KPI BOXES: side legend + bigger spacing */
  .kpi{display:flex;gap:12px;flex-wrap:wrap;margin:6px 0 2px}
  .kpi .box{
    background:#fff;border:1px solid var(--border);border-radius:10px;
    display:flex;gap:16px;align-items:flex-start;justify-content:space-between;
    padding:12px;min-width:320px;
  }
  .box-left{flex:1 1 auto;min-width:220px}
  .box-left b{display:block;font-size:18px;margin-bottom:14px} /* větší rozestup nad bublinami */
  .box-right{flex:0 0 140px;border-left:1px solid var(--border);padding-left:12px}
  .legend{display:flex;flex-direction:column;gap:6px;font-size:12px;color:#4b5563;margin:0}
  .legend .rowline{display:flex;align-items:center;gap:8px}
  .legend .dot{width:12px;height:12px;border-radius:999px;display:inline-block}
  .dot.l0{background:var(--b0);border:1px solid var(--b0b)}
  .dot.l1{background:var(--b1);border:1px solid var(--b1b)}
  .dot.l2{background:var(--b2);border:1px solid var(--b2b)}
  .dot.l3{background:var(--b3);border:1px solid var(--b3b)}

  /* Bubble cluster */
  .bubbles{display:flex;gap:20px;align-items:flex-end;margin-top:6px} /* trochu větší mezery */
  .bubble{display:flex;align-items:center;justify-content:center;border-radius:999px; position:relative; border:1px solid var(--border); color:#0f172a}
  .bubble .lbl{position:absolute;top:-18px;font-size:11px;color:#374151}
  .bubble .val{font-weight:700;font-size:12px}
  .level0{background:var(--b0); border-color:var(--b0b)}
  .level1{background:var(--b1); border-color:var(--b1b)}
  .level2{background:var(--b2); border-color:var(--b2b)}
  .level3{background:var(--b3); border-color:var(--b3b)}

  /* Area-colored separators (as in semesters) */
  .area-divider{margin:8px 0 12px;border-top:0;height:10px}
  .a2hr{background:linear-gradient(90deg,var(--area2),transparent)}
  .a3hr{background:linear-gradient(90deg,var(--area3),transparent)}
  .a4hr{background:linear-gradient(90deg,var(--area4),transparent)}
  .a5hr{background:linear-gradient(90deg,var(--area5),transparent)}
  .a6hr{background:linear-gradient(90deg,var(--area6),transparent)}

  /* Area badges remain .a2 .a3 ... */

  /* Overview tables with area-colored accents */
  .table{width:100%;border-collapse:collapse;background:#fff;border:1px solid var(--border);border-radius:12px;overflow:hidden}
  .table th,.table td{padding:10px;border-bottom:1px solid var(--border);text-align:left;font-size:14px;vertical-align:middle}
  .flex{display:flex;gap:8px;align-items:center}
  .spark{display:block;width:120px;height:36px}
  .table.a2-outline{border-left:4px solid var(--area2)}
  .table.a3-outline{border-left:4px solid var(--area3)}
  .table.a4-outline{border-left:4px solid var(--area4)}
  .table.a5-outline{border-left:4px solid var(--area5)}
  .table.a6-outline{border-left:4px solid var(--area6)}
  .table.a2-outline thead th{background:linear-gradient(180deg, rgba(255,176,0,.16), transparent)}
  .table.a3-outline thead th{background:linear-gradient(180deg, rgba(107,191,89,.16), transparent)}
  .table.a4-outline thead th{background:linear-gradient(180deg, rgba(255,106,0,.16), transparent)}
  .table.a5-outline thead th{background:linear-gradient(180deg, rgba(211,181,143,.26), transparent)}
  .table.a6-outline thead th{background:linear-gradient(180deg, rgba(138,160,184,.20), transparent)}

  /* Area KPI boxes colored left border */
  .area-box.a2box{border-left:4px solid var(--area2)}
  .area-box.a3box{border-left:4px solid var(--area3)}
  .area-box.a4box{border-left:4px solid var(--area4)}
  .area-box.a5box{border-left:4px solid var(--area5)}
  .area-box.a6box{border-left:4px solid var(--area6)}

  footer{margin:24px 0 60px;color:var(--muted)}

  @media print{
    header,.tabs,.toolbar,.pill,.scale label,input[type="range"]{display:none !important}
    .anchors{display:block !important}
    .tab-panel{display:block !important}
    body{background:#fff}
    .card{break-inside:avoid}
  }
</style>
</head>
<body>
<header>
  <h1>SKPKS – Sebehodnocení kompetencí studenta učitelství</h1>
  <p>Revidovaný kompetenční rámec s hodnocením na škále 0–3.</p>
</header>

<div class="wrap">
  <div class="sticky-summary">
    <div class="tabs" role="tablist" aria-label="Semestry">
      <button class="tab-btn" role="tab" aria-selected="true" data-tab="s2">2. semestr</button>
      <button class="tab-btn" role="tab" aria-selected="false" data-tab="s3">3. semestr</button>
      <button class="tab-btn" role="tab" aria-selected="false" data-tab="s4">4. semestr</button>
      <button class="tab-btn" role="tab" aria-selected="false" data-tab="s5">5. semestr</button>
      <button class="tab-btn" role="tab" aria-selected="false" data-tab="s6">6. semestr</button>
      <button class="tab-btn" role="tab" aria-selected="false" data-tab="vyvoj">Vývoj &amp; přehled</button>
    </div>
    <div class="toolbar">
      <span class="chip" id="scaleChip">
        <strong>Vyberte úroveň rozvoje kompetence, kde se právě nacházíte.</strong>
        Škála: 0 = chybějící • 1 = utvářející se • 2 = rozvíjející se • 3 = pokročilá
      </span>
      <label class="switch" id="anchorsSwitch"><input id="toggleAnchors" type="checkbox" /> Zobrazit slovní kotvy</label>
      <button id="pdfBtn" class="btn">Export do PDF</button>
    </div>
    <div class="help" id="howHelp">
      <strong>Jak psát zdůvodnění skóre:</strong> stručně uveďte co jsem dělal(a) (konkrétní postup/příklad) v rámci semestru,
      že se na škále takto hodnotíte, <em>důkaz</em> (odkaz na přípravu, pracovní list, ...),
      a <em>co bude další krok</em> (co změním příště). Přílohy můžete přiložit níže.
    </div>
  </div>

  <section id="s2" class="tab-panel"></section>
  <section id="s3" class="tab-panel" hidden></section>
  <section id="s4" class="tab-panel" hidden></section>
  <section id="s5" class="tab-panel" hidden></section>
  <section id="s6" class="tab-panel" hidden></section>

  <section id="vyvoj" class="tab-panel" hidden>
    <h2>Přehled vývoje napříč semestry</h2>

    <h3>Souhrn za semestry</h3>
    <div class="kpi" id="kpiSem"></div>

    <h3>Souhrn po oblastech (napříč všemi semestry)</h3>
    <div class="kpi" id="kpiAreas"></div>

    <h3>Trajektorie jednotlivých kompetencí</h3>
    <div id="trajWrap"></div>
  </section>

  <footer class="small">
    <p><strong>Pozn.:</strong> Export do PDF využívá tiskové styly.</p>
  </footer>
</div>

<script>
/** ====== Oblasti (2–6) ====== */
const AREAS = {
  2: {label:"2 Plánování výuky", badge:"a2", color:"#ffb000"},
  3: {label:"3 Prostředí pro učení", badge:"a3", color:"#6bbf59"},
  4: {label:"4 Výuka a strategie", badge:"a4", color:"#ff6a00"},
  5: {label:"5 Hodnocení a zpětná vazba", badge:"a5", color:"#d3b58f"},
  6: {label:"6 Spolupráce a profesní rozvoj", badge:"a6", color:"#8aa0b8"}
};
const AREA_KEYS = Object.keys(AREAS).map(Number).sort((a,b)=>a-b);

/** ====== Rámec (zkrácené/parafráze úrovní 0–3) ====== */
const CRITS = [
  {id:"2.1a", area:2, name:"Konzultuji přípravu – návaznost na ŠVP", text:"Při plánování pracuji s kurikulárními dokumenty a konzultuji přípravu s provázejícím učitelem.",
   anchors:["Neznám ŠVP/tematický plán ani předchozí práci; přípravu nekonzultuji, nereaguji na připomínky.","Konzultuji bez předchozí znalosti návazností; připomínky nezapracovávám.","Plánuji v návaznosti na ŠVP/tematický plán a předchozí práci; v průběhu konzultací přípravu upravuji.","Plánuji v návaznosti na ŠVP/tematický plán a předchozí práci; připomínky provázejícího samostatně zapracovávám a rozvíjím."]},
  {id:"2.1b", area:2, name:"Cíle – komplexní nastavení (OVU, KK, gramotnosti)", text:"Cíle plánuji komplexně ve vztahu k OVU, klíčovým kompetencím a gramotnostem.",
   anchors:["Cíle směřují jen do jedné oblasti (např. pouze kognitivní).","Občas cíle rozšířím o další oblasti; gramotnosti/průřezová témata zařazuji intuitivně.","Cíleně směřuji k naplňování OVU a rozvoji klíčových kompetencí; plánuji gramotnosti a průřezová témata.","Systematicky propojuji OVU, klíčové kompetence, gramotnosti i průřezová témata."]},
  {id:"2.1c", area:2, name:"Formuluji ověřitelné cíle", text:"Formuluji ověřitelné výukové cíle v různých doménách a navazuji na koncepci výuky.",
   anchors:["Cíle nestanovuji; plánuji pouze obsah.","Cíle formuluji příležitostně a nesystematicky; nejsou ověřitelné.","S podporou formuluji ověřitelné cíle v souladu s koncepcí výuky.","Samostatně formuluji ověřitelné cíle v souladu s koncepcí a OVU."]},
  {id:"2.1d", area:2, name:"Plánuji ověření cílů (zapojení žáků)", text:"Plánuji způsoby ověření naplnění cílů včetně zapojení žáků do procesu.",
   anchors:["Neplánuji, jak ověřím naplnění cílů.","Plánuji povrchní způsoby ověření; žáky do ověřování nezapojuji.","S podporou plánuji ověření cílů a zapojení žáků.","Samostatně plánuji ověřování cílů žáky i provázejícím; informace využívám pro další plánování."]},
  {id:"2.1e", area:2, name:"Provádím didaktickou analýzu učiva", text:"Provádím didaktickou analýzu učiva (pojmy, vztahy, úlohy) s akcentem na udržitelnost.",
   anchors:["Analýzu provádím nesystematicky; zaměřuji se hlavně na výběr úloh.","Analýza je intuitivní; opomíjím mezipředmětové vztahy a širší kontext.","S podporou zohledňuji klíčové pojmy, vztahy i širší kontext s akcentem na udržitelnost.","Analýzu provádím samostatně, promyšleně, s ohledem na potřeby žáků a cíle; vycházím z více zdrojů a principů udržitelného rozvoje."]},
  {id:"2.2a", area:2, name:"Volba metod, forem a prostředků k cílům", text:"Plánuji metody, organizační formy a prostředky adekvátní cílům a potřebám žáků.",
   anchors:["Volby neodpovídají cílům; jsou spíše intuitivní.","Volím spíše intuitivně a spoléhám na osvědčené postupy bez širší analýzy.","S podporou volím metody/formy/prostředky tak, aby většinou odpovídaly cílům.","Samostatně a promyšleně volím pestrou škálu metod/forem/prostředků přizpůsobenou cílům a specifikům učiva."]},
  {id:"2.3a", area:2, name:"Časový plán – reálnost a efektivita", text:"Plánuji časový průběh výuky s ohledem na cíle a efektivitu.",
   anchors:["Časový plán není promyšlen; odhad času je slabý.","S dopomocí naplánuji čas; odhad se zlepšuje.","Samostatně zpracovávám reálný časový plán.","Plánuji i varianty pro nenadálé situace; zachovávám rytmus a koherenci."]},
  {id:"2.3b", area:2, name:"Čas a učení žáků – relevance rozložení", text:"Časové rozložení aktivit odráží jejich význam pro učení žáků.",
   anchors:["Plán není realizovatelný; aktivity nelze stihnout nebo nenaplní hodinu.","Celková délka sedí, rozložení neodráží význam aktivit pro učení.","Celková délka sedí; většina aktivit je časově přiměřená jejich významu.","Časové rozložení aktivit systematicky odráží jejich význam pro učení žáků."]},
  {id:"2.3c", area:2, name:"Rovnováha práce–život, využití zdrojů", text:"Promyšleně volím mezi vlastní tvorbou a hotovými materiály; zapojuji žáky.",
   anchors:["Nevyužívám hotové materiály; vše tvořím sám/sama i za cenu nadměrné zátěže.","Využívám hotové materiály bez hlubší vazby na cíle.","Vhodně využívám hotové materiály a inspiraci; zatím málo přenáším aktivitu na žáky.","Tvořivě kombinuji vlastní a hotové materiály podle cílů a potřeb; zapojuji žáky a usiluji o udržitelné pracovní nasazení."]},
  {id:"2.4a", area:2, name:"Individualizace a diferenciace plánu", text:"Individualizuji a diferencuji plán výuky dle informací o žácích a SVP.",
   anchors:["Nezjišťuji individuální potřeby; plánuji „pro všechny stejně“.","Aktivity běžně nezohledňují individuální potřeby; spoléhám na asistenta.","Informuji se o potřebách a při plánování je zohledňuji (včetně nadaných, SVP, IVP).","Znám potřeby všech žáků; plánuji tak, aby se zapojil každý a naplnil svůj potenciál."]},
  {id:"3.1a", area:3, name:"Respektující komunikace, oslovení jménem", text:"Buduji prostředí důvěry a respektu; žáci jsou oslovováni jménem.",
   anchors:["Respekt není patrný; žáky neoslovuji jménem.","Respekt není vždy patrný; oslovuji jen některé žáky jménem.","Komunikace je zpravidla respektující; všechny žáky oslovuji jménem.","Komunikace je vždy respektující; je patrný zájem o všechny žáky; všechny oslovuji jménem."]},
  {id:"3.1b", area:3, name:"Postupy pro budování důvěry a práci s pravidly", text:"Nastavuji očekávání, oceňuji pozitivní projevy a odkazuji na pravidla.",
   anchors:["Nemám vyjasněno očekávané chování; pravidla nejsou jasná ani dodržovaná.","Požadavky a postupy jsou nepředvídatelné; pravidla jsou spíše formální.","Postupy a požadavky jsou většinou konzistentní; s pravidly pracuji důsledně; oceňuji popisným jazykem.","Předcházím nevhodnému chování konzistentními postupy; pravidla jsou živou součástí kultury."]},
  {id:"3.1c", area:3, name:"Pozitivní vztahy a vzájemné poznávání", text:"Vedu žáky k vzájemnému poznávání a budování pozitivních vztahů.",
   anchors:["Vztahy nepodporuji a nevěnuji se jim.","Vztahů si všímám, ale cíleně je nepodporuji.","Sleduji vztahy a záměrně vytvářím příležitosti k jejich rozvoji.","Znalosti o žácích využívám k budování důvěry a spolupráce; modeluji význam pozitivních vztahů."]},
  {id:"3.2a", area:3, name:"Reakce na konfliktní situace", text:"Všímám si rizikového chování, reaguji klidně a spravedlivě.",
   anchors:["Rizikové chování nerozpoznávám/neraguji; nepřizvu podporu.","Rizikové chování vnímám, ale reaguji nejistě; potřebuji výraznou podporu.","Rizikové chování rozpoznám a přiměřeně reaguji; spolupracuji s provázejícím.","Citlivě a včas rozpoznám rizika; reaguji s ohledem na potřeby žáků; preventivně spolupracuji na řešení."]},
  {id:"3.2b", area:3, name:"Spolupráce vs. soutěž ve třídě", text:"Podporuji spolupráci a promyšleně pracuji s prvky soutěže.",
   anchors:["Nevnímám význam spolupráce; dopady soutěže nesleduji.","Uvědomuji si význam spolupráce; soutěž zařazuji nepromyšleně.","Aktivně podporuji spolupráci a soutěž zařazuji promyšleně.","Sleduji a hodnotím dopad spolupráce a soutěže na učení žáků."]},
  {id:"3.2c", area:3, name:"Socioemoční rozvoj žáků", text:"Vedu žáky k uvědomění emocí/potřeb a dopadu chování.",
   anchors:["Nevnímám potřeby a emoce žáků; aktivity nereflektuji.","Nahodile reflektuji emoce a potřeby; upozorňuji na dopady chování.","Aktivně vedu k sebepoznání a modeluji žádoucí chování.","Systematicky vytvářím příležitosti a oporu pro vědomou reflexi emocí, potřeb a dopadu chování."]},
  {id:"3.3a", area:3, name:"Organizace práce a žákovské strategie", text:"Vedu žáky k efektivní organizaci práce a strategiím učení.",
   anchors:["Důležitost organizace a strategií nevnímám.","Uvědomuji si důležitost, ale neuplatňuji ji systematicky.","Aktivně vedu žáky k osvojování strategií a návyků.","Sleduji a hodnotím dopad strategií; podporuji efektivní postupy."]},
  {id:"3.3b", area:3, name:"Prostor a uspořádání třídy", text:"Přizpůsobuji uspořádání a pomůcky cílům a potřebám žáků.",
   anchors:["Prostředí nepřizpůsobuji; držím frontální uspořádání; nepoužívám pomůcky.","Prostor měním nahodile; pomůcky využívám výjimečně.","Nejistě přizpůsobuji prostor potřebám a cílům; pomůcky volím mechanicky.","Aktivně přizpůsobuji prostor a promyšleně integruji pomůcky a vybavení."]},
  {id:"3.3c", area:3, name:"Digitální prostředí a nástroje (ICT)", text:"Využívám digitální nástroje/lms dle pravidel školy a potřeb žáků.",
   anchors:["Digitální nástroje nevyužívám.","Zřídka využívám digitální nástroje v souladu s pravidly a potřebami.","Nahodile zařazuji digitální nástroje v souladu s pravidly a potřebami.","Promyšleně integruji digitální nástroje pro podporu učení žáků."]},
  {id:"4.1a", area:4, name:"Porozumění cílům (sdělit/vyvodit)", text:"Zprostředkovávám (nebo vyvozuji) cíle a ověřuji žákovské porozumění.",
   anchors:["Cíle nezprostředkovávám/nevysvětluji.","Cíle sděluji spíše formálně; neověřuji porozumění.","Cíle sdělím či vyvodím; příležitostně ověřuji porozumění.","Systematicky pracuji s cíli a ověřuji, že jim žáci rozumí."]},
  {id:"4.1b", area:4, name:"Průběžné ověřování naplnění cílů (zapojení žáků)", text:"Průběžně ověřuji dosahování cílů a zapojuji žáky do vyhodnocování.",
   anchors:["Dosažení cílů neověřuji.","Bezděčně a neplánovaně vyhodnocuji spíše u jednotlivců.","Plánovaně ověřuji dosažení cílů u všech žáků.","Plánovaně ověřuji dosažení cílů a vytvářím příležitost pro zapojení žáků."]},
  {id:"4.2a", area:4, name:"Smysl a význam učiva", text:"Komunikuji a objevujeme se žáky význam učiva a jeho propojení s realitou.",
   anchors:["Smysluplnosti se nevěnuji; žáci neví proč se učí.","Na základě zájmu sděluji, proč se něco učíme.","Sděluji význam učiva a přesah do života.","Diskutuji se žáky a vedu je k objevení významu; smysluplnost je výrazná součást výuky."]},
  {id:"4.2b", area:4, name:"Navázání na předchozí znalosti a zkušenosti", text:"Vysvětluji učivo s využitím předchozích znalostí a zkušeností žáků.",
   anchors:["Předchozí znalosti nezjišťuji a nevyužívám.","Zjišťuji, ale neověřuji; návaznost jen zmiňuji.","Diskutuji o předchozích zkušenostech a ověřuji znalosti; reakce nejsou vždy adekvátní.","Otevřeně komunikuji o předchozích znalostech a aktivně na ně reaguji; vytvářím prostor pro rekapitulaci."]},
  {id:"4.2c", area:4, name:"Didaktické zprostředkování obsahu (věcná správnost)", text:"Zprostředkovávám obsah podle aktuálního poznání a věku/potřeb žáků.",
   anchors:["Nevyhodnocuji zdroje; obsah nepřizpůsobuji věku/potřebám.","Vyjdu z jednoho zdroje a přizpůsobím věku/potřebám.","Porovnávám aktuální zdroje a volím informace dle věku/potřeb.","Plánovaně volím různé odborné zdroje, kriticky je hodnotím a přizpůsobuji věku/potřebám."]},
  {id:"4.3a", area:4, name:"Srozumitelné instrukce", text:"Poskytuji srozumitelné instrukce dle vzdělávacích potřeb a ověřuji porozumění.",
   anchors:["Instrukce nejsou srozumitelné.","Instrukce jen ústně a pro všechny stejně.","Instrukce srozumitelně a strukturovaně různými formami dle potřeb žáků.","Proaktivně přizpůsobuji instrukce a ověřuji porozumění."]},
  {id:"4.3b", area:4, name:"Metody a formy podporující učení", text:"Volím metody a formy, které vedou k cílům; reflektuji vliv na učení.",
   anchors:["Metody/organizační formy nejsou efektivní k cílům.","Zkouším metody a formy; efekt není stabilní.","Volím efektivní metody/formy; vedu žáky k reflexi dopadu.","Nabízím různorodé metody/formy a vedu k samostatné volbě dle cílů."]},
  {id:"4.3c", area:4, name:"Reakce na nenadálé situace", text:"Pružně a citlivě reaguji na nenadálé situace během výuky.",
   anchors:["Na nenadálé situace nereaguji; držím se plánu.","Reaguji na některé situace s cílem rychle se vrátit k plánu.","Reaguji a někdy situace citlivě řeším.","Pružně a citlivě reaguji a řeším situace ve spolupráci s žáky."]},
  {id:"4.3d", area:4, name:"Přebírání odpovědnosti žáků za učení", text:"Vedu žáky k plánování, volbě strategií a vyhodnocování učení.",
   anchors:["Nevytvářím prostor pro metakognici a odpovědnost za učení.","Příležitostně vedu žáky k přemýšlení o učení.","Žáci pojmenovávají strategie a vědomě volí; podporuji reflexi.","Systematicky vedu žáky k přebírání odpovědnosti za své učení."]},
  {id:"5.1a", area:5, name:"Popisný jazyk ve zpětné vazbě", text:"Poskytuji respektující průběžnou ZV s popisným jazykem a ohledem na potřeby.",
   anchors:["ZV neposkytuji; hodnotím obecně (osoba/výrok).","Poskytuji ZV konkretizující, co se daří/nedaří.","ZV konkretizuje, co se daří/nedaří a v čem je pokrok.","ZV konkretizuje, co se daří/nedaří, v čem je pokrok a jak zlepšit výkon."]},
  {id:"5.1b", area:5, name:"Kritéria hodnocení", text:"Pracuji s kritérii srozumitelnými žákům a tvořenými ideálně společně.",
   anchors:["S kritérii nepracuję; žáci neví, podle čeho jsou hodnoceni.","ZV dle mých/přejatých kritérií bez rozboru se žáky.","ZV dle mých/přejatých kritérií, která předem nastavím a žáci jim rozumí.","ZV dle společně vytvořených kritérií; žáci jim rozumí."]},
  {id:"5.1c", area:5, name:"Individualizace zpětné vazby", text:"Zohledňuji individuální potřeby a cíle žáků při ZV.",
   anchors:["Při ZV nezohledňuji individuální potřeby.","Zohledňuji potřeby dle instrukcí provázejícího.","Ve spolupráci s provázejícím potřeby zohledňuji.","Samostatně zohledňuji potřeby; ZV směřuji k cílům žáků."]},
  {id:"5.1d", area:5, name:"Práce s chybou", text:"Využívám příležitosti pro práci s chybou (detekce–identifikace–korekce–interpretace).",
   anchors:["Rozhoduji o chybném/správném; chybu rovnou opravuji.","Upozorním na chybu; žák ji opraví.","Chybu využívám k učení: žák chybu identifikuje, opraví a zdůvodní.","Záměrně vytvářím problémové situace; žáci chybu identifikují a opravují s argumentací."]},
  {id:"5.2a", area:5, name:"Různé metody a formy hodnocení", text:"Využívám rozmanité metody a ukazatele pokroku (formativní×sumativní).",
   anchors:["Hodnotím převážně známkou (sumativně).","Známky doplňuji o jiné formy; občas krátký komentář.","Vyvažuji formativní a sumativní hodnocení; rozmanité metody.","Rozmanité metody s ohledem na sledování pokroku; různé ukazatele výsledků učení."]},
  {id:"5.2b", area:5, name:"Zapojení žáků do plánování a ověřování cílů", text:"Se žáky plánuji cestu k cílům a ověřuji jejich naplnění.",
   anchors:["Se žáky nesleduji pokrok ani neplánuji cestu k cíli.","Sleduji pokrok s oporou o různé formy a metody hodnocení.","Se žáky sleduji jejich pokrok.","Se žáky ověřuji naplnění cílů a plánujeme postup s využitím různých ukazatelů."]},
  {id:"5.3a", area:5, name:"Sebehodnocení žáků", text:"Vedu žáky k reflexi procesu i výsledků učení (sebehodnocení).",
   anchors:["Sebehodnocení nezařazuji/neumím zařadit.","Sebehodnocení zařazuji nahodile (spíše emoční).","Sebehodnocení zařazuji pravidelně, včetně popisného jazyka.","Sebehodnocení promyšleně ve vztahu k cílům, kritériím a plánování učení; žáci si je zaznamenávají."]},
  {id:"5.3b", area:5, name:"Vzájemné hodnocení žáků", text:"Vedu žáky k poskytování ZV druhým dle srozumitelných kritérií.",
   anchors:["Vzájemné hodnocení nezařazuji/neumím zařadit.","Zařazuji občas a nahodile; neprobíhá podle kritérií.","Plánovaně na základě srozumitelných kritérií.","Promyšleně dle srozumitelných/společně stanovených kritérií; žáci používají popisný jazyk."]},
  {id:"6.1a", area:6, name:"Tandemová výuka – plánování, vedení, reflexe", text:"Vedu výuku v tandemu; plánujeme, vedeme a vyhodnocujeme společně.",
   anchors:["Na tandemové výuce se nepodílím.","Podílím se spíše pasivně; přijímám návrhy provázejícího.","Plánuji, připravuji a vedu tandemovou výuku; reflexe nepravidelně.","Cíleně plánuji, připravuji, vedu a pravidelně reflektuji s oporou o SKPKS."]},
  {id:"6.1b", area:6, name:"Komunikace s rodiči", text:"Zapojení do komunikace s rodiči (dle možností praxe) a využití výstupů pro podporu žáků.",
   anchors:["Komunikaci s rodiči nevyhledávám.","Seznamuji se s rodiči (osobně/písemně), sbírám podněty a konzultuji s provázejícím.","Pod vedením formuluji sdělení nebo se účastním jednání s rodiči.","Dle dohody se samostatně zapojuji do komunikace a navrhuji využití výstupů pro rozvoj žáků."]},
  {id:"6.2a", area:6, name:"Sebepojetí v roli učitele – očekávání, obavy, potřeby", text:"Pracuji se svým sebepojetím, očekáváními a obavami; umím si říct o pomoc.",
   anchors:["O své roli nepřemýšlím.","O roli přemýšlím; identifikuji obavy.","Pojmenovávám očekávání, obavy a potřeby; sdílím je s provázejícím.","Systematicky s nimi pracuji a využívám podporu."]},
  {id:"6.2b", area:6, name:"Cíle profesního rozvoje a kroky v praxi", text:"Stanovuji adekvátní cíle rozvoje, realizuji kroky a průběžně vyhodnocuji.",
   anchors:["Cíle nechci/nedokážu pojmenovat.","Cíle pojmenuji, ale nejsou konkrétní/dosažitelné/měřitelné.","Cíle pojmenuji; kroky nerealizuji nebo je nenavrhuji.","Cíle i kroky (časový plán) formuluji, realizuji a vyhodnocuji."]},
  {id:"6.2c", area:6, name:"Reflexe výuky se ZV provázejícího", text:"Reflektuji průběh výuky s oporou o zpětnou vazbu provázejícího.",
   anchors:["Reflexi neprovádím; ZV provázejícího ignoruji.","Pokouším se o (sebe)reflexi; připomínky začleňuji částečně.","Provádím podrobnou analýzu a navrhuji, jak připomínky začlenit.","Kriticky reflektuji výuku a samostatně navrhuji řešení."]},
  {id:"6.2d", area:6, name:"Využití ZV žáků pro rozvoj", text:"Využívám zpětnou vazbu žáků pro svůj profesní rozvoj.",
   anchors:["Nevytvářím příležitosti pro zapojení žáků do hodnocení výuky.","Zapojení je nahodilé.","Zapojení je pravidelné a rozmanité.","Systematicky sbírám ZV žáků a využívám ji v dalších hodinách."]},
  {id:"6.3a", area:6, name:"Vědomá péče o zdraví a zdroje", text:"Sleduji rovnováhu práce–život a stav svého zdraví; reaguji na zátěž.",
   anchors:["Nevěnuji pozornost sobě ani svému zdraví.","Všímám si dopadu zátěže/stresu, ale nereaguji.","Všímám si změn, zacházím uvážlivě se zdroji; coping zatím omezeně.","Věnuji odpovídající pozornost a proaktivně pečuji o své zdraví."]},
  {id:"6.3b", area:6, name:"Mezilidské vztahy", text:"Navazuji a udržuji hodnotné kolegiální vztahy.",
   anchors:["Kolegiální vztahy nevyhledávám/nerozvíjím.","Využívám příležitosti k navazování vztahů.","Příležitosti aktivně vytvářím.","O vztahy pečuji a udržuji je dlouhodobě."]}
];

const SEMS = ["s2","s3","s4","s5","s6"];

/** ====== Stav hodnot a souborů ====== */
let state = { s2:{}, s3:{}, s4:{}, s5:{}, s6:{} };          // hodnoty 0–3
let filesState = { s2:{}, s3:{}, s4:{}, s5:{}, s6:{} };      // počty souborů u kritérií

function setValue(sem, id, val){
  state[sem][id] = (val==="" || val===null) ? null : Number(val);
  if(currentTab==="vyvoj") renderVyvoj();
}
function getValue(sem, id){ const v = state[sem][id]; return (v===undefined)? null : v; }
function countArtifactsForCrit(id){
  return SEMS.reduce((acc,sem)=>acc + (filesState[sem]?.[id]||0), 0);
}
function isNumber(v){ return typeof v==="number"; }

/** ====== UI: render semestru ====== */
function renderSemester(semId){
  const host = document.getElementById(semId);
  host.innerHTML = "";
  const semTitle = {"s2":"2. semestr","s3":"3. semestr","s4":"4. semestr","s5":"5. semestr","s6":"6. semestr"}[semId];
  const h2 = document.createElement("h2"); h2.textContent = semTitle; host.appendChild(h2);

  AREA_KEYS.forEach(areaNo => {
    const area = AREAS[areaNo];
    const hr = document.createElement("div"); hr.className = `area-divider ${area.badge}hr`; host.appendChild(hr);
    const h3 = document.createElement("h3"); h3.innerHTML = `<span class="badge ${area.badge}">${area.label}</span>`; host.appendChild(h3);

    const grid = document.createElement("div"); grid.className = "grid"; host.appendChild(grid);

    CRITS.filter(c => c.area===areaNo).forEach(c => {
      const card = document.createElement("article"); card.className = "card";
      card.innerHTML = `
        <div class="row">
          <span class="badge ${area.badge}">${c.id}</span>
          <h3>${c.name}</h3>
        </div>
        <div class="muted">${c.text}</div>
        <div class="row scale">
          <label class="pill">0</label>
          <input type="range" min="0" max="3" step="1" value="${getValue(semId,c.id)??""}" aria-label="Skóre ${c.id}" />
          <label class="pill">3</label>
          <span class="muted">Skóre: <span class="small" data-val>${getValue(semId,c.id)??"—"}</span></span>
        </div>
        <div class="anchors" data-anchors>
          <div><strong>Slovní kotvy (0–3)</strong></div>
          <ul>
            <li><strong>0</strong> – ${c.anchors[0]}</li>
            <li><strong>1</strong> – ${c.anchors[1]}</li>
            <li><strong>2</strong> – ${c.anchors[2]}</li>
            <li><strong>3</strong> – ${c.anchors[3]}</li>
          </ul>
        </div>
        <div>
          <label class="muted">Zdůvodnění / doložení</label>
          <textarea class="note">Zdůvodněte vybrané skóre:</textarea>
          <div class="row">
            <input class="file-input" type="file" multiple accept=".pdf,.png,.jpg,.jpeg,.webp,.gif" />
          </div>
          <div class="files" data-files></div>
        </div>
      `;
      const slider = card.querySelector('input[type="range"]');
      const out = card.querySelector('[data-val]');
      slider.addEventListener('input', (e)=>{
        const v = Number(e.target.value);
        out.textContent = `${v}`;
        setValue(semId, c.id, v);
      });

      // Správa souborů (zobrazení náhledů) + uložení počtu
      const fileInput = card.querySelector('.file-input');
      const filesWrap = card.querySelector('[data-files]');
      fileInput.addEventListener('change', (e)=>{
        filesWrap.innerHTML = "";
        const files = Array.from(e.target.files || []);
        filesState[semId][c.id] = files.length;
        files.forEach(f=>{
          const div = document.createElement('div'); div.className = 'file-thumb';
          if(f.type.startsWith('image/')){
            const img = document.createElement('img');
            img.alt = f.name;
            div.appendChild(img);
            const reader = new FileReader();
            reader.onload = ev => { img.src = ev.target.result; };
            reader.readAsDataURL(f);
            const cap = document.createElement('div'); cap.textContent = f.name; cap.className="small muted";
            div.appendChild(cap);
          }else{
            div.textContent = f.name;
          }
          filesWrap.appendChild(div);
        });
        if(currentTab==="vyvoj") renderVyvoj();
      });

      grid.appendChild(card);
    });
  });
}

function renderAllSemesters(){ SEMS.forEach(renderSemester); }

/** ====== Souhrny (bubliny) ====== */
function perSemesterCounts(){
  return SEMS.map(sem => {
    const vals = CRITS.map(c => getValue(sem,c.id)).filter(v => v!==null && v!==undefined);
    const counts = {0:0,1:0,2:0,3:0};
    vals.forEach(v => { if(isNumber(v)) counts[v]++; });
    return {sem, counts};
  });
}

function perAreaCounts(){
  return AREA_KEYS.map(area => {
    const crits = CRITS.filter(c=>c.area===area);
    const counts = {0:0,1:0,2:0,3:0};
    SEMS.forEach(sem => {
      crits.forEach(c => {
        const v = getValue(sem,c.id);
        if(isNumber(v)) counts[v]++;
      });
    });
    return {area, counts, label: AREAS[area].label, badge: AREAS[area].badge};
  });
}

/** ====== Bublinový graf ====== */
function renderBubbles(container, counts){
  container.innerHTML = "";
  const max = Math.max(1, counts[0], counts[1], counts[2], counts[3]);
  [0,1,2,3].forEach(level => {
    const val = counts[level] || 0;
    const size = 26 + Math.round(50 * (val/max)); // zvětšeno: 26..76 px
    const b = document.createElement("div");
    b.className = `bubble level${level}`;
    b.style.width = size+"px";
    b.style.height = size+"px";
    b.setAttribute("title", `Úroveň ${level}: ${val}`);
    const lbl = document.createElement("div"); lbl.className="lbl"; lbl.textContent = level;
    const v = document.createElement("div"); v.className="val"; v.textContent = val;
    b.appendChild(lbl); b.appendChild(v);
    container.appendChild(b);
  });
}

/** ====== Render souhrnných boxů (s boční legendou) ====== */
function renderKPIBlocks(){
  // Semestry
  const semHost = document.getElementById("kpiSem"); semHost.innerHTML="";
  perSemesterCounts().forEach(({sem, counts})=>{
    const box = document.createElement("div"); box.className="box";
    const left = document.createElement("div"); left.className="box-left";
    const right = document.createElement("div"); right.className="box-right";
    const label = {"s2":"2. semestr","s3":"3. semestr","s4":"4. semestr","s5":"5. semestr","s6":"6. semestr"}[sem];

    left.innerHTML = `<b>${label}</b>`;
    const bubbles = document.createElement("div"); bubbles.className = "bubbles";
    renderBubbles(bubbles, counts);
    left.appendChild(bubbles);

    right.innerHTML = `<div class="legend">
        <div class="rowline"><span class="dot l0"></span> Úroveň 0</div>
        <div class="rowline"><span class="dot l1"></span> Úroveň 1</div>
        <div class="rowline"><span class="dot l2"></span> Úroveň 2</div>
        <div class="rowline"><span class="dot l3"></span> Úroveň 3</div>
      </div>`;

    box.appendChild(left); box.appendChild(right);
    semHost.appendChild(box);
  });

  // Oblasti – barevné orámování + stejný layout
  const areaHost = document.getElementById("kpiAreas"); areaHost.innerHTML="";
  perAreaCounts().forEach(({area, counts, label, badge})=>{
    const box = document.createElement("div"); box.className=`box area-box ${badge}box`;
    const left = document.createElement("div"); left.className="box-left";
    const right = document.createElement("div"); right.className="box-right";

    left.innerHTML = `<b>${label}</b>`;
    const bubbles = document.createElement("div"); bubbles.className = "bubbles";
    renderBubbles(bubbles, counts);
    left.appendChild(bubbles);

    right.innerHTML = `<div class="legend">
        <div class="rowline"><span class="dot l0"></span> Úroveň 0</div>
        <div class="rowline"><span class="dot l1"></span> Úroveň 1</div>
        <div class="rowline"><span class="dot l2"></span> Úroveň 2</div>
        <div class="rowline"><span class="dot l3"></span> Úroveň 3</div>
      </div>`;

    box.appendChild(left); box.appendChild(right);
    areaHost.appendChild(box);
  });
}

/** ====== Trajektorie (po oblastech) – barevné oddělení tabulek ====== */
const SUBJECTS = [
  "Základy pedagogického myšlení",
  "Úvod do kognitivní a sociální psychologie",
  "Speciální a inkluzivní pedagogika",
  "Vývojová psychologie",
  "Asistentská praxe/doučování a sebezkušenost ve škole a sebezkušenost",
  "Sebezkušenostní příprava na profesi I",
  "Sebezkušenostní příprava na profesi II",
  "Poznávání žáka",
  "Asistentská praxe/doučovací praxe",
  "Podpora rozvoje nadání",
  "Komunikační strategie podporující učení",
  "Oborová praxe",
  "Bezpečné prostředí pro učení"
];

function seededRandom(seed){
  let s = seed % 2147483647; if (s <= 0) s += 2147483646;
  return function(){ s = s * 16807 % 2147483647; return (s - 1) / 2147483646; };
}
function getSubjectsForCrit(id){
  let seed = 0; for(let i=0;i<id.length;i++){ seed += id.charCodeAt(i)*(i+1); }
  const rand = seededRandom(seed);
  const n = 1 + Math.floor(rand()*4);
  const idxs = new Set(); while(idxs.size < n){ idxs.add(Math.floor(rand()*SUBJECTS.length)); }
  return Array.from(idxs).map(i=>SUBJECTS[i]);
}

function renderTrajectories(){
  const wrap = document.getElementById("trajWrap");
  wrap.innerHTML = "";
  AREA_KEYS.forEach(areaNo => {
    const area = AREAS[areaNo];
    const hr = document.createElement("div"); hr.className = `area-divider ${area.badge}hr`; wrap.appendChild(hr);
    const h3 = document.createElement("h3"); h3.innerHTML = `<span class="badge ${area.badge}">${area.label}</span>`; wrap.appendChild(h3);

    const table = document.createElement("table"); table.className = `table ${area.badge}-outline`;
    table.innerHTML = `<thead><tr>
        <th style="width:88px">Kód</th><th>Kompetence</th>
        <th style="width:52px">2.</th><th style="width:52px">3.</th><th style="width:52px">4.</th><th style="width:52px">5.</th><th style="width:52px">6.</th>
        <th style="width:130px">Trend</th><th style="width:90px">Artefakty</th><th style="width:320px">Předměty</th>
      </tr></thead><tbody></tbody>`;
    const tb = table.querySelector("tbody");

    CRITS.filter(c=>c.area===areaNo).forEach(c => {
      const tr = document.createElement("tr");
      const artifacts = countArtifactsForCrit(c.id);
      tr.innerHTML = `
        <td><strong>${c.id}</strong></td>
        <td>${c.name}</td>
        ${SEMS.map(sem=>`<td style="text-align:center">${getValue(sem,c.id)??"—"}</td>`).join("")}
        <td class="flex"><svg class="spark" viewBox="0 0 100 30" preserveAspectRatio="none"></svg></td>
        <td style="text-align:center">${artifacts}</td>
        <td class="small">${getSubjectsForCrit(c.id).join(", ")}</td>
      `;
      tb.appendChild(tr);
      const svg = tr.querySelector(".spark");
      const vals = SEMS.map(sem=>getValue(sem,c.id));
      const points = vals.map((v,i)=>{
        const x = i*(100/(SEMS.length-1));
        const y = 30 - (v===null? 0 : v/3*30);
        return {x,y,empty:(v===null)};
      });
      const d = points.map((p,i)=>`${i===0?'M':'L'} ${p.x},${p.empty?30:p.y}`).join(" ");
      const path = document.createElementNS("http://www.w3.org/2000/svg","path");
      path.setAttribute("d", d);
      path.setAttribute("fill","none");
      path.setAttribute("stroke", "#0044cc");
      path.setAttribute("stroke-width","2");
      svg.appendChild(path);
      points.forEach(p=>{
        const circle = document.createElementNS("http://www.w3.org/2000/svg","circle");
        circle.setAttribute("cx", p.x); circle.setAttribute("cy", p.empty?30:p.y); circle.setAttribute("r","2.6");
        circle.setAttribute("fill", "#0044cc");
        svg.appendChild(circle);
      });
    });
    wrap.appendChild(table);
  });
}

/** ====== Tabs & kotvy ====== */
let currentTab = "s2";
const scaleChip = document.getElementById("scaleChip");
const anchorsSwitch = document.getElementById("anchorsSwitch");
const helpBox = document.getElementById("howHelp");

document.querySelectorAll(".tab-btn").forEach(btn=>{
  btn.addEventListener("click",()=>{
    const id = btn.getAttribute("data-tab");
    currentTab = id;
    document.querySelectorAll(".tab-panel").forEach(p=>{ p.hidden = p.id!==id; });
    document.querySelectorAll(".tab-btn").forEach(b=>b.setAttribute("aria-selected", String(b===btn)));
    if(id==="vyvoj"){
      if(scaleChip) scaleChip.style.display = "none";
      if(anchorsSwitch) anchorsSwitch.style.display = "none";
      if(helpBox) helpBox.style.display = "none";
      renderVyvoj();
    }else{
      if(scaleChip) scaleChip.style.display = "inline-flex";
      if(anchorsSwitch) anchorsSwitch.style.display = "inline-flex";
      if(helpBox) helpBox.style.display = "block";
    }
  });
});

// Přepínač kotev
document.getElementById("toggleAnchors").addEventListener("change", (e)=>{
  const show = e.target.checked;
  document.querySelectorAll('[data-anchors]').forEach(el=>{
    el.style.display = show? 'block' : 'none';
  });
});

// Export do PDF
document.getElementById("pdfBtn").addEventListener("click", ()=>{ window.print(); });

/** ====== Render "Vývoj" ====== */
function renderVyvoj(){
  renderKPIBlocks();
  renderTrajectories();
}

/** ====== Inicializace ====== */
renderAllSemesters();
</script>
</body>
</html>
